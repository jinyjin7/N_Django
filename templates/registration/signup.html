<!-- signup.html -->
<form id="signupForm">
    <input type="email" id="email" placeholder="이메일" required>
    <input type="text" id="name" placeholder="이름" required>
    <input type="password" id="password" placeholder="비밀번호" required>
    <input type="password" id="password2" placeholder="비밀번호 확인" required>
    <button type="submit">회원가입</button>
</form>

<script>
async function signup(userData) {
    try {
        const response = await fetch('http://localhost:8000/api/signup/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken'), // Django CSRF 토큰
            },
            body: JSON.stringify(userData)
        });

        const data = await response.json();

        if (response.ok) {
            alert(data.message); // "회원가입이 완료되었습니다."
            window.location.href = 'api/login/'; // 로그인 페이지로 이동
        } else {
            console.error('회원가입 실패:', data);
            displayErrors(data); // 에러 표시
        }
    } catch (error) {
        console.error('네트워크 에러:', error);
    }
}

// 폼 제출 처리
document.getElementById('signupForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const userData = {
        email: document.getElementById('email').value,
        name: document.getElementById('name').value,
        password: document.getElementById('password').value,
        password2: document.getElementById('password2').value,
    };

    signup(userData);
});
</script>